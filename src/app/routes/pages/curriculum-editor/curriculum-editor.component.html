<br />

<div class="container">
  <div class="row justify-content-center">
    <h1 class="text-center">Curriculum Editor</h1>
  </div>
  <div class="row">
    <div class="col-sm-6 mt-2">
      <mat-card>
        <mat-card-header>
          <span style="flex: 1 1 auto"></span>
          <span>

            <h4 class="">Course Structure</h4>
          </span>
          <span style="flex: 1 1 auto"></span>
          <span>  
              <button mat-raised-button color="primary"
                (click)="openDialog()">Create New Version</button>
          </span>
          <span style="flex: 1 1 auto"></span>
        </mat-card-header>
        <mat-card-content>
      <mat-accordion>
          <mat-expansion-panel *ngFor="let cname of curriculumNames">
            <mat-expansion-panel-header>
              <mat-panel-title>
                {{cname}}
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div *ngFor="let curriculum of getCurriculumsByName(cname)">
              <mat-toolbar>
                <span *ngIf="curriculum.name === cname">
                  {{curriculum.version}}
                </span>
                <span *ngIf="curriculum.name !== cname">
                  <del>{{curriculum.version}}</del>
                </span>
                <span class="fill-remaining-space">
                </span>
                <span *ngIf="curriculum.name === cname">
                  <button mat-mini-fab color="primary" (click)="deactivateCurriculum(curriculum)">X</button>
                </span>
                <span *ngIf="curriculum.name !== cname">
                  <button mat-mini-fab color="'green'" (click)="reactivateCurriculum(curriculum)">+</button>
                </span>
              </mat-toolbar>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </mat-card-content>
    </mat-card>
    </div>
    <div class="col-sm-6 mt-2">
      <mat-card >
      <mat-card-header>
          <span style="flex: 1 1 auto"></span>
            <h3 class="m-0 p-0">Topic Pool</h3>
          <span style="flex: 1 1 auto"></span>
              <mat-form-field class="my-0 pb-0">
                  <input matInput color="accent" type="text" placeholder="Search Subtopic" [(ngModel)]="topicSearch">
                  <button mat-button *ngIf="value" matSuffix mat-icon-button aria-label="Clear" (click)="value=''">
                    <mat-icon>close</mat-icon>
                  </button>
                </mat-form-field>
          <span>
              <button mat-button color="accent"mat-icon-button aria-label="add" (click)="openNewDialog()">
                  <mat-icon>add</mat-icon>
                </button>
          </span>
          <span style="flex: 1 1 auto"></span>
        </mat-card-header>
        <mat-card-content style="overflow: auto; height: 470px;">
      <mat-accordion>
        <mat-card-content>
          <div *ngFor="let topic of topics">
          <mat-expansion-panel [disabled]="topic.name !== topicService.reactivateName(topic.name)"
            [expanded]="topic.name === topicService.reactivateName(topic.name) &amp;&amp; isExpanded(topic.id)"
            (opened)="expandTopic(topic.id)" (closed)="collapseTopic(topic.id)">
            <mat-expansion-panel-header>
              <mat-panel-title *ngIf="topic.name === topicService.reactivateName(topic.name)">
                
                  <span>
                    {{topic.name}}
                  </span>
                  <span class="fill-remaining-space">
                  </span>
                  <span>
                    <button mat-icon-button color="primary" (click)="deactivateTopic(topic)">
                        <mat-icon color="primary">clear</mat-icon>
                    </button>
                  </span>
                
              </mat-panel-title>
              <mat-panel-title *ngIf="topic.name !== topicService.reactivateName(topic.name)">
                  <span>
                    <del>{{topicService.reactivateName(topic.name)}}</del>
                  </span>
                  <span class="fill-remaining-space">
                  </span>
                  <span>
                    <button mat-icon-button color="" (click)="reactivateTopic(topic)">
                        <mat-icon color="">add</mat-icon>
                    </button>
                  </span>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div *ngFor="let subtopic of getSubtopicsByTopic(topic)">
              <div *ngIf="(!topicSearch || ((subtopic.name | lowercase).indexOf(topicSearch | lowercase) >= 0)) &amp;&amp; (subtopicService.reactivateName(subtopic.name) === subtopic.name)">
                <mat-toolbar>
                  <span> {{(subtopic.name | slice:0:35)}}</span>
                  <span class="fill-remaining-space"></span>
                  <span>
                      <button mat-icon-button color="" (click)="deactivateSubtopic(subtopic)">
                          <mat-icon color="primary">clear</mat-icon>
                      </button>
                  </span>
                </mat-toolbar>
              </div>
              <div *ngIf="(!topicSearch || ((subtopic.name | lowercase).indexOf(topicSearch | lowercase) >= 0)) &amp;&amp; (subtopicService.reactivateName(subtopic.name) !== subtopic.name)">
                <mat-toolbar>
                  <span> <del>{{ subtopicService.reactivateName(subtopic.name) }}</del></span>
                  <span class="fill-remaining-space"> </span>
                  <span>
                      <button mat-icon-button color="" (click)="reactivateSubtopic(subtopic)">
                          <mat-icon color="">add</mat-icon>
                      </button>
                  </span>
                </mat-toolbar>
              </div>
            </div>
            <div *ngIf="getSubtopicsByTopic(topic).length == 0">
              No Subtopics for {{ topic.name }}
            </div>
          </mat-expansion-panel>
          </div>
        </mat-card-content>
      </mat-accordion>
    </mat-card-content>
    </mat-card>
    </div>
  </div>
</div>
